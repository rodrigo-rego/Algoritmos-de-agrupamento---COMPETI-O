from sklearn.cluster import KMeans
from sklearn.datasets import load_iris
import matplotlib.pyplot as plt
import seaborn as sns
import pandas as pd
from sklearn.metrics import silhouette_score

data = load_iris()
X = data.data

kmeans = KMeans(n_clusters=4, random_state=0, n_init=100, max_iter=10)
kmeans.fit(X)
sillueta = silhouette_score(X, kmeans.labels_)
print(f'Silhouette: {sillueta:.3f}')
labels = kmeans.labels_

df = pd.DataFrame(X, columns=data.feature_names[:2])
df['Cluster'] = labels
labelsname = list()
  
for l in labels:
    labelsname.append("Cluster "+str(l))

sns.scatterplot(x=X[:, 0], y=X[:, 1], hue=labelsname, palette='viridis', s=50)
plt.scatter(kmeans.cluster_centers_[:, 0], kmeans.cluster_centers_[:, 1], c='red', marker='X', s=200, label='Centroids')
plt.xlabel(data.feature_names[0])
plt.ylabel(data.feature_names[1])
plt.legend()
print(f'Silhouette Score: {sillueta:.3f}')
print(f'Número de clusters: {len(kmeans.cluster_centers_)}')
print(f'Número de iterações: {kmeans.n_iter_}')
print(f'Número de execuções: {kmeans.n_init}')
plt.title("Gáfico K-Means ")
plt.show()
